{% extends 'librarycore/index.html' %}

{% block maintitle %}{{book.bookName}} - Details{% endblock %}

{% block content %}
<div class="container">
	<p>Title: {{book.bookName}}</p>
	<p>Author: {{book.bookAuthor.authorName}}</p>
	<p>Description: {{book.bookDescription}}</p>
</div>

{% if isAdmin %}
<div class="container">
	<a class="btn btn-success" id="btnInstanceNewShow" onclick="instanceNewToggle()">New instance</a>
	<form method="post" id="formNewInstance" hidden="true" action="{% url 'instance-create' %}">
		{% csrf_token %}
		<input type="hidden" name="bookId" value="{{book.id}}">
		<select name="instanceType">
			{% for it1, it2 in instanceTypes %}
			<option value="{{it1}}">{{it2}}</option>
			{% endfor %}
		</select>
		<button class="btn btn-success">Create</button>
	</form>
</div>
{% endif %}


<div class="container">
	<hr>
	{% if instances.count == 0 %}
	<p>No copies available</p>
	{% else %}
	<h2>{{instances.count}} copies of {{book.bookName}}</h2>
	{% for instance in instances %}
	<div class="row">
		<div class="col-2">
			{% for it1, it2 in instanceTypes %}
			{% if it1 == instance.instanceType %}
			{{it2}}
			{% endif %}
			{% endfor %}
		</div>
		<div class="col">
			<a href="{% url 'instance-detail' instance.instanceSerialNum %}">{{instance.instanceSerialNum}}</a>
		</div>
		<div class="col">
			{% if instance.borrowedBy %}
			<span class="badge badge-danger">Not available</span>
			{% else %}
			<span class="badge badge-success">Available</span>
			{% endif %}
		</div>
	</div>
	{% endfor %}
	{% endif %}
</div>

{% if isAdmin %}
<script>
	function instanceNewToggle() {
		$(" #btnInstanceNewShow").attr("hidden", true); $("#formNewInstance").attr("hidden", false);
	}
</script>
{% endif %}

{% endblock %}
